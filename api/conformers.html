

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>arc.species.conformers &mdash; ARC 1.1.0 Documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="arc.reaction" href="reaction.html" />
    <link rel="prev" title="arc.species.converter" href="converter.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> ARC
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running.html">Running ARC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced.html">Advanced Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../output.html">Output</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ARC’s API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="main.html">arc.main</a></li>
<li class="toctree-l2"><a class="reference internal" href="species.html">arc.species.species</a></li>
<li class="toctree-l2"><a class="reference internal" href="converter.html">arc.species.converter</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">arc.species.conformers</a></li>
<li class="toctree-l2"><a class="reference internal" href="reaction.html">arc.reaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="scheduler.html">arc.scheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="job.html">arc.job.job</a></li>
<li class="toctree-l2"><a class="reference internal" href="ssh.html">arc.job.ssh</a></li>
<li class="toctree-l2"><a class="reference internal" href="local.html">arc.job.local</a></li>
<li class="toctree-l2"><a class="reference internal" href="parser.html">arc.parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="plotter.html">arc.plotter</a></li>
<li class="toctree-l2"><a class="reference internal" href="processor.html">arc.processor</a></li>
<li class="toctree-l2"><a class="reference internal" href="rmgdb.html">arc.rmgdb</a></li>
<li class="toctree-l2"><a class="reference internal" href="common.html">arc.common</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">Standalone tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">How to cite ARC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../licence.html">Licence</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ARC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">ARC’s API</a> &raquo;</li>
        
      <li>arc.species.conformers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/conformers.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-arc.species.conformers">
<span id="arc-species-conformers"></span><span id="conformers"></span><h1>arc.species.conformers<a class="headerlink" href="#module-arc.species.conformers" title="Permalink to this headline">¶</a></h1>
<p>A module for (non-TS) species conformer generation</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>variables that contain atom indices such as torsions and tops are 1-indexed,
while atoms in Molecules are 0-indexed.</p>
</div>
<p>conformers is a list of dictionaries, each with the following keys:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;xyz&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">dict</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="s1">&#39;FF energy&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">str</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="s1">&#39;torsion_dihedrals&#39;</span><span class="p">:</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">torsion</span> <span class="nb">tuple</span> <span class="mi">0</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">angle</span> <span class="mi">0</span><span class="p">,</span>
                       <span class="o">&lt;</span><span class="n">torsion</span> <span class="nb">tuple</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">angle</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">}</span>
</pre></div>
</div>
<p>Module workflow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">generate_conformers</span>
    <span class="n">generate_force_field_conformers</span>
        <span class="n">get_force_field_energies</span><span class="p">,</span> <span class="n">rdkit_force_field</span> <span class="ow">or</span> <span class="n">mix_rdkit_and_openbabel_force_field</span><span class="p">,</span> <span class="n">determine_dihedrals</span>
    <span class="n">deduce_new_conformers</span>
        <span class="n">get_torsion_angles</span><span class="p">,</span> <span class="n">determine_torsion_symmetry</span><span class="p">,</span> <span class="n">determine_torsion_sampling_points</span><span class="p">,</span>
        <span class="n">change_dihedrals_and_force_field_it</span>
    <span class="n">get_lowest_confs</span>
</pre></div>
</div>
<dl class="function">
<dt id="arc.species.conformers.change_dihedrals_and_force_field_it">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">change_dihedrals_and_force_field_it</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">mol</em>, <em class="sig-param">xyz</em>, <em class="sig-param">torsions</em>, <em class="sig-param">new_dihedrals</em>, <em class="sig-param">optimize=True</em>, <em class="sig-param">force_field='MMFF94s'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#change_dihedrals_and_force_field_it"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.change_dihedrals_and_force_field_it" title="Permalink to this definition">¶</a></dt>
<dd><p>Change dihedrals of specified torsions according to the new dihedrals specified, and get FF energies.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">torsions</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">new_dihedrals</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">120</span><span class="p">],</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span> <span class="p">[</span><span class="mi">180</span><span class="p">,</span> <span class="mi">270</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">270</span><span class="p">]]</span>
</pre></div>
</div>
<p>This will calculate the energy of the original conformer (defined using <cite>xyz</cite>).
We iterate through new_dihedrals. The torsions are set accordingly and the energy and xyz of the newly
generated conformer are kept.</p>
<p>We assume that each list entry in new_dihedrals is of the length of the torsions list (2 in the example).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>mol</strong> (<em>Molecule</em>) – The RMG molecule with the connectivity information.</p></li>
<li><p><strong>xyz</strong> (<em>dict</em>) – The base 3D geometry to be changed.</p></li>
<li><p><strong>torsions</strong> (<em>list</em>) – Entries are torsion tuples for which the dihedral will be changed relative to xyz.</p></li>
<li><p><strong>new_dihedrals</strong> (<em>list</em>) – Entries are same size lists of dihedral angles (floats) corresponding to the torsions.</p></li>
<li><p><strong>optimize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to optimize the coordinates using FF. True to optimize.</p></li>
<li><p><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The conformer FF energies corresponding to the list of dihedrals.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The conformer xyz geometries corresponding to the list of dihedrals.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.check_atom_collisions">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">check_atom_collisions</code><span class="sig-paren">(</span><em class="sig-param">xyz</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#check_atom_collisions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.check_atom_collisions" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether atoms are too close to each other.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>xyz</strong> (<em>dict</em>) – The 3D geometry.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if they are colliding, False otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.check_special_non_rotor_cases">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">check_special_non_rotor_cases</code><span class="sig-paren">(</span><em class="sig-param">mol</em>, <em class="sig-param">top1</em>, <em class="sig-param">top2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#check_special_non_rotor_cases"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.check_special_non_rotor_cases" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether one of the tops correspond to a special case which could not be rotated
<cite>mol</cite> is the RMG Molecule to diagnose
<cite>top1</cite> and <cite>top2</cite> are indices of atoms on each side of the pivots, the first index corresponds to one of the pivots</p>
<p>Special cases considered are:</p>
<ul class="simple">
<li><p>cyano groups: <code class="docutils literal notranslate"><span class="pre">R-C#N</span></code></p></li>
<li><p>azide groups: <code class="docutils literal notranslate"><span class="pre">N-N#N</span></code></p></li>
</ul>
<p>These cases have a 180 degree angle and torsion is meaningless, but they are identified by our methods since they
have a single bond
Returns <cite>True</cite> if this is indeed a special case which should not be treated as a rotor</p>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.compare_xyz">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">compare_xyz</code><span class="sig-paren">(</span><em class="sig-param">xyz1</em>, <em class="sig-param">xyz2</em>, <em class="sig-param">precision=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#compare_xyz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.compare_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare coordinates of two conformers of the same species. Not checking isotopes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz1</strong> (<em>dict</em>) – Coordinates of conformer 1 in either string or array format.</p></li>
<li><p><strong>xyz2</strong> (<em>dict</em>) – Coordinates of conformer 2 in either string or array format.</p></li>
<li><p><strong>precision</strong> (<em>float</em><em>, </em><em>optional</em>) – The allowed difference threshold between coordinates, in Angstroms.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether the coordinates represent the same conformer within the given <code class="docutils literal notranslate"><span class="pre">precision</span></code>, <code class="docutils literal notranslate"><span class="pre">True</span></code> if they do.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>InputError</strong> – If <code class="docutils literal notranslate"><span class="pre">xyz1</span></code> and <code class="docutils literal notranslate"><span class="pre">xyz2</span></code> arer of wrong type or have different elements (not considering isotopes).</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.conformers_combinations_by_lowest_conformer">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">conformers_combinations_by_lowest_conformer</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">mol</em>, <em class="sig-param">base_xyz</em>, <em class="sig-param">multiple_tors</em>, <em class="sig-param">multiple_sampling_points</em>, <em class="sig-param">len_conformers=-1</em>, <em class="sig-param">force_field='MMFF94s'</em>, <em class="sig-param">max_combination_iterations=25</em>, <em class="sig-param">torsion_angles=None</em>, <em class="sig-param">multiple_sampling_points_dict=None</em>, <em class="sig-param">wells_dict=None</em>, <em class="sig-param">de_threshold=None</em>, <em class="sig-param">plot_path=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#conformers_combinations_by_lowest_conformer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.conformers_combinations_by_lowest_conformer" title="Permalink to this definition">¶</a></dt>
<dd><p>Iteratively modify dihedrals in the lowest conformer (each iteration deduce the new lowest conformer),
until convergence.
untested</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>mol</strong> (<em>Molecule</em>) – The RMG molecule with the connectivity information.</p></li>
<li><p><strong>base_xyz</strong> (<em>dict</em>) – The base 3D geometry to be changed.</p></li>
<li><p><strong>multiple_tors</strong> (<em>list</em>) – Entries are torsion tuples of non-symmetric torsions.</p></li>
<li><p><strong>multiple_sampling_points</strong> (<em>list</em>) – Entries are lists of dihedral angles (sampling points), respectively correspond
to torsions in multiple_tors.</p></li>
<li><p><strong>len_conformers</strong> (<em>int</em><em>, </em><em>optional</em>) – The length of the existing conformers list (for consecutive numbering).</p></li>
<li><p><strong>de_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – An energy threshold (in kJ/mol) above which wells in a torsion
will not be considered.</p></li>
<li><p><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use.</p></li>
<li><p><strong>max_combination_iterations</strong> (<em>int</em><em>, </em><em>optional</em>) – The max num of times to iteratively search for the lowest conformer.</p></li>
<li><p><strong>torsion_angles</strong> (<em>dict</em><em>, </em><em>optional</em>) – The torsion angles. Keys are torsion tuples, values are lists of all
corresponding angles from conformers.</p></li>
<li><p><strong>multiple_sampling_points_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keys are torsion tuples, values are respective sampling points.</p></li>
<li><p><strong>wells_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keys are torsion tuples, values are well dictionaries.</p></li>
<li><p><strong>plot_path</strong> (<em>str</em><em>, </em><em>optional</em>) – A folder path in which the plot will be saved.
If None, the plot will not be shown (nor saved).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New conformer combinations, entries are conformer dictionaries.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.deduce_new_conformers">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">deduce_new_conformers</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">conformers</em>, <em class="sig-param">torsions</em>, <em class="sig-param">tops</em>, <em class="sig-param">mol_list</em>, <em class="sig-param">smeared_scan_res=None</em>, <em class="sig-param">plot_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#deduce_new_conformers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.deduce_new_conformers" title="Permalink to this definition">¶</a></dt>
<dd><p>By knowing the existing torsion wells, get the geometries of all important conformers.
Validate that atoms don’t collide in the generated conformers (don’t consider ones where they do).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>conformers</strong> (<em>list</em>) – Entries are conformer dictionaries.</p></li>
<li><p><strong>torsions</strong> (<em>list</em>) – A list of all possible torsion angles in the molecule, each torsion angles list is sorted.</p></li>
<li><p><strong>tops</strong> (<em>list</em>) – A list of tops corresponding to torsions.</p></li>
<li><p><strong>mol_list</strong> (<em>list</em>) – A list of RMG Molecule objects.</p></li>
<li><p><strong>smeared_scan_res</strong> (<em>float</em><em>, </em><em>optional</em>) – The resolution (in degrees) for scanning smeared wells.</p></li>
<li><p><strong>plot_path</strong> (<em>str</em><em>, </em><em>optional</em>) – A folder path in which the plot will be saved.
If None, the plot will not be shown (nor saved).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>many inter-level variables.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.determine_dihedrals">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">determine_dihedrals</code><span class="sig-paren">(</span><em class="sig-param">conformers</em>, <em class="sig-param">torsions</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#determine_dihedrals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.determine_dihedrals" title="Permalink to this definition">¶</a></dt>
<dd><p>For each conformer in <cite>conformers</cite> determine the respective dihedrals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conformers</strong> (<em>list</em>) – Entries are conformer dictionaries.</p></li>
<li><p><strong>torsions</strong> (<em>list</em>) – All possible torsions in the molecule.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Entries are conformer dictionaries.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.determine_number_of_conformers_to_generate">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">determine_number_of_conformers_to_generate</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">heavy_atoms</em>, <em class="sig-param">torsion_num</em>, <em class="sig-param">minimalist=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#determine_number_of_conformers_to_generate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.determine_number_of_conformers_to_generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the number of conformers to generate using molecular mechanics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>heavy_atoms</strong> (<em>int</em>) – The number of heavy atoms in the molecule.</p></li>
<li><p><strong>torsion_num</strong> (<em>int</em>) – The number of potential torsions in the molecule.</p></li>
<li><p><strong>minimalist</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return a small number of conformers, useful when this is just a guess
before fitting a force field. True to be minimalistic.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>number of conformers to generate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ConformerError</strong> – If the number of conformers to generate cannot be determined.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.determine_rotors">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">determine_rotors</code><span class="sig-paren">(</span><em class="sig-param">mol_list</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#determine_rotors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.determine_rotors" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine possible unique rotors in the species to be treated as hindered rotors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mol_list</strong> (<em>list</em>) – Localized structures (Molecule objects) by which all rotors will be determined.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of indices of scan pivots.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of indices of top atoms (including one of the pivotal atoms) corresponding to the torsions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.determine_top_group_indices">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">determine_top_group_indices</code><span class="sig-paren">(</span><em class="sig-param">mol</em>, <em class="sig-param">atom1</em>, <em class="sig-param">atom2</em>, <em class="sig-param">index=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#determine_top_group_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.determine_top_group_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the indices of a “top group” in a molecule.
The top is defined as all atoms connected to atom2, including atom2, excluding the direction of atom1.
Two <code class="docutils literal notranslate"><span class="pre">atom_list_to_explore</span></code> are used so the list the loop iterates through isn’t changed within the loop.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Molecule</em>) – The Molecule object to explore.</p></li>
<li><p><strong>atom1</strong> (<em>Atom</em>) – The pivotal atom in mol.</p></li>
<li><p><strong>atom2</strong> (<em>Atom</em>) – The beginning of the top relative to atom1 in mol.</p></li>
<li><p><strong>index</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return 1-index or 0-index conventions. 1 for 1-index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The indices of the atoms in the top (either 0-index or 1-index, as requested).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether the top has heavy atoms (is not just a hydrogen atom). True if it has heavy atoms.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.determine_torsion_sampling_points">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">determine_torsion_sampling_points</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">torsion_angles</em>, <em class="sig-param">smeared_scan_res=None</em>, <em class="sig-param">symmetry=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#determine_torsion_sampling_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.determine_torsion_sampling_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine how many points to consider in each well of a torsion for conformer combinations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>torsion_angles</strong> (<em>list</em>) – Well angles in the torsion.</p></li>
<li><p><strong>smeared_scan_res</strong> (<em>float</em><em>, </em><em>optional</em>) – The resolution (in degrees) for scanning smeared wells.</p></li>
<li><p><strong>symmetry</strong> (<em>int</em><em>, </em><em>optional</em>) – The torsion symmetry number.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Sampling points for the torsion.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Each entry is a well dictionary with the keys
<code class="docutils literal notranslate"><span class="pre">start_idx</span></code>, <code class="docutils literal notranslate"><span class="pre">end_idx</span></code>, <code class="docutils literal notranslate"><span class="pre">start_angle</span></code>, <code class="docutils literal notranslate"><span class="pre">end_angle</span></code>, <code class="docutils literal notranslate"><span class="pre">angles</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.determine_torsion_symmetry">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">determine_torsion_symmetry</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">top1</em>, <em class="sig-param">mol_list</em>, <em class="sig-param">torsion_scan</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#determine_torsion_symmetry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.determine_torsion_symmetry" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether a torsion is symmetric.</p>
<p>If a torsion well is “well defined” and not smeared, it could be symmetric.
Check the groups attached to the rotor pivots to determine whether it is indeed symmetric
We don’t care about the actual rotor symmetry number here, since we plan to just use the first well
(they’re all the same).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>top1</strong> (<em>list</em>) – A list of atom indices on one side of the torsion, including the pivotal atom.</p></li>
<li><p><strong>mol_list</strong> (<em>list</em>) – A list of molecules.</p></li>
<li><p><strong>torsion_scan</strong> (<em>list</em>) – The angles corresponding to this torsion from all conformers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The rotor symmetry number.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.determine_well_width_tolerance">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">determine_well_width_tolerance</code><span class="sig-paren">(</span><em class="sig-param">mean_width</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#determine_well_width_tolerance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.determine_well_width_tolerance" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the tolerance by which well widths are determined to be nearly equal.</p>
<p>Fitted to a polynomial trend line for the following data of (mean, tolerance) pairs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">),</span> <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">),</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">),</span> <span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.59</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mean_width</strong> (<em>float</em>) – The mean well width in degrees.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The tolerance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.embed_rdkit">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">embed_rdkit</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">mol</em>, <em class="sig-param">num_confs=None</em>, <em class="sig-param">xyz=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#embed_rdkit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.embed_rdkit" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate random conformers (unoptimized) in RDKit</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>mol</strong> (<em>RMG Molecule</em><em> or </em><em>RDKit RDMol</em>) – The molecule object with connectivity and bond order information.</p></li>
<li><p><strong>num_confs</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of random 3D conformations to generate.</p></li>
<li><p><strong>xyz</strong> (<em>dict</em><em>, </em><em>optional</em>) – The 3D coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An RDKIt molecule with embedded conformers.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>RDMol</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The atom mapping dictionary.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.find_internal_rotors">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">find_internal_rotors</code><span class="sig-paren">(</span><em class="sig-param">mol</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#find_internal_rotors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.find_internal_rotors" title="Permalink to this definition">¶</a></dt>
<dd><p>Locates the sets of indices corresponding to every internal rotor (1-indexed).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Molecule</em>) – The molecule for which rotors will be determined</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Entries are rotor dictionaries with the four-atom scan coordinates, the pivots, and the smallest top.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.generate_all_combinations">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">generate_all_combinations</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">mol</em>, <em class="sig-param">base_xyz</em>, <em class="sig-param">multiple_tors</em>, <em class="sig-param">multiple_sampling_points</em>, <em class="sig-param">len_conformers=-1</em>, <em class="sig-param">force_field='MMFF94s'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#generate_all_combinations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.generate_all_combinations" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate all combinations of torsion wells from a base conformer.
untested</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>mol</strong> (<em>Molecule</em>) – The RMG molecule with the connectivity information.</p></li>
<li><p><strong>base_xyz</strong> (<em>dict</em>) – The base 3D geometry to be changed.</p></li>
<li><p><strong>multiple_tors</strong> (<em>list</em>) – Entries are torsion tuples of non-symmetric torsions.</p></li>
<li><p><strong>multiple_sampling_points</strong> (<em>list</em>) – Entries are lists of dihedral angles (sampling points), respectively correspond
to torsions in multiple_tors.</p></li>
<li><p><strong>len_conformers</strong> (<em>int</em><em>, </em><em>optional</em>) – The length of the existing conformers list (for consecutive numbering).</p></li>
<li><p><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New conformer combinations, entries are conformer dictionaries.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.generate_all_enantiomers">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">generate_all_enantiomers</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">mol</em>, <em class="sig-param">xyz</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#generate_all_enantiomers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.generate_all_enantiomers" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate all combinations of enantiomers for a given conformer’s coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>mol</strong> (<em>Molecule</em>) – The 2D graph representation of the molecule.</p></li>
<li><p><strong>xyz</strong> (<em>dict</em>) – The 3D coordinates of the molecule with the same atom order as in <code class="docutils literal notranslate"><span class="pre">mol</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of string-format coordinates of all enantiomer combinations.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.generate_conformer_combinations">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">generate_conformer_combinations</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">mol</em>, <em class="sig-param">base_xyz</em>, <em class="sig-param">hypothetical_num_comb</em>, <em class="sig-param">multiple_tors</em>, <em class="sig-param">multiple_sampling_points</em>, <em class="sig-param">combination_threshold=1000</em>, <em class="sig-param">len_conformers=-1</em>, <em class="sig-param">force_field='MMFF94s'</em>, <em class="sig-param">max_combination_iterations=25</em>, <em class="sig-param">plot_path=None</em>, <em class="sig-param">torsion_angles=None</em>, <em class="sig-param">multiple_sampling_points_dict=None</em>, <em class="sig-param">wells_dict=None</em>, <em class="sig-param">de_threshold=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#generate_conformer_combinations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.generate_conformer_combinations" title="Permalink to this definition">¶</a></dt>
<dd><p>Call either conformers_combinations_by_lowest_conformer() or generate_all_combinations(),
according to the hypothetical_num_comb.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>mol</strong> (<em>Molecule</em>) – The RMG molecule with the connectivity information.</p></li>
<li><p><strong>base_xyz</strong> (<em>dict</em>) – The base 3D geometry to be changed.</p></li>
<li><p><strong>hypothetical_num_comb</strong> (<em>int</em>) – The number of combinations that could be generated by changing dihedrals,
considering symmetry but not considering atom collisions.</p></li>
<li><p><strong>combination_threshold</strong> (<em>int</em><em>, </em><em>optional</em>) – A threshold below which all combinations will be generated.</p></li>
<li><p><strong>multiple_tors</strong> (<em>list</em>) – Entries are torsion tuples of non-symmetric torsions.</p></li>
<li><p><strong>multiple_sampling_points</strong> (<em>list</em>) – Entries are lists of dihedral angles (sampling points), respectively correspond
to torsions in multiple_tors.</p></li>
<li><p><strong>len_conformers</strong> (<em>int</em><em>, </em><em>optional</em>) – The length of the existing conformers list (for consecutive numbering).</p></li>
<li><p><strong>de_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – An energy threshold (in kJ/mol) above which wells in a torsion
will not be considered.</p></li>
<li><p><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use.</p></li>
<li><p><strong>max_combination_iterations</strong> (<em>int</em><em>, </em><em>optional</em>) – The max num of times to iteratively search for the lowest conformer.</p></li>
<li><p><strong>torsion_angles</strong> (<em>dict</em><em>, </em><em>optional</em>) – The torsion angles. Keys are torsion tuples, values are lists of all
corresponding angles from conformers.</p></li>
<li><p><strong>multiple_sampling_points_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keys are torsion tuples, values are respective sampling points.</p></li>
<li><p><strong>wells_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keys are torsion tuples, values are well dictionaries.</p></li>
<li><p><strong>plot_path</strong> (<em>str</em><em>, </em><em>optional</em>) – A folder path in which the plot will be saved.
If None, the plot will not be shown (nor saved).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New conformer combinations, entries are conformer dictionaries.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.generate_conformers">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">generate_conformers</code><span class="sig-paren">(</span><em class="sig-param">mol_list</em>, <em class="sig-param">label</em>, <em class="sig-param">xyzs=None</em>, <em class="sig-param">torsions=None</em>, <em class="sig-param">tops=None</em>, <em class="sig-param">charge=0</em>, <em class="sig-param">multiplicity=None</em>, <em class="sig-param">num_confs=None</em>, <em class="sig-param">num_confs_to_return=None</em>, <em class="sig-param">well_tolerance=None</em>, <em class="sig-param">de_threshold=None</em>, <em class="sig-param">smeared_scan_res=None</em>, <em class="sig-param">combination_threshold=None</em>, <em class="sig-param">force_field='MMFF94s'</em>, <em class="sig-param">max_combination_iterations=None</em>, <em class="sig-param">determine_h_bonds=False</em>, <em class="sig-param">return_all_conformers=False</em>, <em class="sig-param">plot_path=None</em>, <em class="sig-param">print_logs=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#generate_conformers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.generate_conformers" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate conformers for (non-TS) species starting from a list of RMG Molecules.
(resonance structures are assumed to have already been generated and included in the molecule list)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol_list</strong> (<em>list</em><em> or </em><em>Molecule</em>) – Molecule objects to consider (or Molecule, resonance structures will be generated).</p></li>
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>xyzs</strong> (<em>list</em>) – A list of user guess xyzs that will also be taken into account, each in a dict format.</p></li>
<li><p><strong>torsions</strong> (<em>list</em><em>, </em><em>optional</em>) – A list of all possible torsions in the molecule. Will be determined if not given.</p></li>
<li><p><strong>tops</strong> (<em>list</em><em>, </em><em>optional</em>) – A list of tops corresponding to torsions. Will be determined if not given.</p></li>
<li><p><strong>charge</strong> (<em>int</em><em>, </em><em>optional</em>) – The species charge. Used to perceive a molecule from xyz.</p></li>
<li><p><strong>multiplicity</strong> (<em>int</em><em>, </em><em>optional</em>) – The species multiplicity. Used to perceive a molecule from xyz.</p></li>
<li><p><strong>num_confs</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of conformers to generate. Determined automatically if not given.</p></li>
<li><p><strong>num_confs_to_return</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of conformers to return.</p></li>
<li><p><strong>well_tolerance</strong> (<em>float</em><em>, </em><em>optional</em>) – The required precision (in degrees) around which to center a well’s mean.</p></li>
<li><p><strong>de_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Energy threshold (in kJ/mol) above which wells will not be considered.</p></li>
<li><p><strong>smeared_scan_res</strong> (<em>float</em><em>, </em><em>optional</em>) – The resolution (in degrees) for scanning smeared wells.</p></li>
<li><p><strong>combination_threshold</strong> (<em>int</em><em>, </em><em>optional</em>) – A threshold below which all combinations will be generated.</p></li>
<li><p><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use (MMFF94, MMFF94s, UFF, GAFF, fit).
‘fit’ will first run MMFF94, than fit a custom Amber FF to the species.</p></li>
<li><p><strong>max_combination_iterations</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of times to iteratively search
for the lowest conformer.</p></li>
<li><p><strong>determine_h_bonds</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to determine add. conformers w/ hydrogen bonds from the lowest one.</p></li>
<li><p><strong>return_all_conformers</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the full conformers list of conformer dictionaries
In addition to the lowest conformers list. Tru to return it.</p></li>
<li><p><strong>plot_path</strong> (<em>str</em><em>, </em><em>optional</em>) – A folder path in which the plot will be saved.
If None, the plot will not be shown (nor saved).</p></li>
<li><p><strong>print_logs</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether define a logger so logs are also printed to stdout.
Useful when run outside of ARC. True to print.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Lowest conformers (number of entries is num_confs_to_return times the number of enantiomer combinations)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ConformerError</strong> – If something goes wrong.</p></li>
<li><p><strong>TypeError</strong> – If xyzs has entries of a wrong type.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.generate_force_field_conformers">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">generate_force_field_conformers</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">mol_list</em>, <em class="sig-param">torsion_num</em>, <em class="sig-param">charge</em>, <em class="sig-param">multiplicity</em>, <em class="sig-param">xyzs=None</em>, <em class="sig-param">num_confs=None</em>, <em class="sig-param">force_field='MMFF94s'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#generate_force_field_conformers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.generate_force_field_conformers" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate conformers using RDKit and Open Babel and optimize them using a force field
Also consider user guesses in <cite>xyzs</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>mol_list</strong> (<em>list</em>) – Entries are Molecule objects representing resonance structures of a chemical species.</p></li>
<li><p><strong>xyzs</strong> (<em>list</em><em>, </em><em>optional</em>) – Entries are xyz coordinates in dict format, given as initial guesses.</p></li>
<li><p><strong>torsion_num</strong> (<em>int</em>) – The number of torsions identified in the molecule.</p></li>
<li><p><strong>charge</strong> (<em>int</em>) – The net charge of the species.</p></li>
<li><p><strong>multiplicity</strong> (<em>int</em>) – The species spin multiplicity.</p></li>
<li><p><strong>num_confs</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of conformers to generate.</p></li>
<li><p><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Entries are conformer dictionaries.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ConformerError</strong> – If xyzs is given and it is not a list, or its entries are not strings.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.get_force_field_energies">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">get_force_field_energies</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">mol</em>, <em class="sig-param">num_confs=None</em>, <em class="sig-param">xyz=None</em>, <em class="sig-param">force_field='MMFF94s'</em>, <em class="sig-param">optimize=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#get_force_field_energies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.get_force_field_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine force field energies using RDKit.
If num_confs is given, random 3D geometries will be generated. If xyz is given, it will be directly used instead.
The coordinates are returned in the order of atoms in mol.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>mol</strong> (<em>Molecule</em>) – The RMG molecule object with connectivity and bond order information.</p></li>
<li><p><strong>num_confs</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of random 3D conformations to generate.</p></li>
<li><p><strong>xyz</strong> (<em>dict</em><em>, </em><em>optional</em>) – The 3D coordinates guess.</p></li>
<li><p><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use.</p></li>
<li><p><strong>optimize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to first optimize the conformer using FF. True to optimize.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Entries are xyz coordinates, each in a dict format.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Entries are the FF energies (in kJ/mol).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.get_lowest_confs">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">get_lowest_confs</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">confs</em>, <em class="sig-param">n=1</em>, <em class="sig-param">energy='FF energy'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#get_lowest_confs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.get_lowest_confs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the most stable conformer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>confs</strong> (<em>list</em>) – Entries are either conformer dictionaries or a length two list of xyz coordinates and energy.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – Number of lowest conformers to return.</p></li>
<li><p><strong>energy</strong> (<em>str</em><em>, </em><em>optional</em>) – The energy attribute to search by. Currently only ‘FF energy’ is supported.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Conformer dictionaries.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.get_lp_vector">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">get_lp_vector</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">mol</em>, <em class="sig-param">xyz</em>, <em class="sig-param">pivot</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#get_lp_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.get_lp_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a vector from the pivotal atom in the molecule towards its lone electron pairs.
The approach is to reverse the average of the three unit vectors between the pivotal atom and its neighbors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>mol</strong> (<em>Molecule</em>) – The 2D graph representation of the molecule.</p></li>
<li><p><strong>xyz</strong> (<em>dict</em>) – The 3D coordinates of the molecule with the same atom order as in mol.</p></li>
<li><p><strong>pivot</strong> (<em>int</em>) – The 0-index of the pivotal atom around which groups are to be translated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A vector pointing from the pivotal atom towards its lone electron pairs orbital.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.get_normal">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">get_normal</code><span class="sig-paren">(</span><em class="sig-param">v1</em>, <em class="sig-param">v2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#get_normal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.get_normal" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a normal vector using cross multiplication.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v1</strong> (<em>list</em>) – Vector 1.</p></li>
<li><p><strong>v2</strong> (<em>list</em>) – Vector 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A normal unit vector to v1 and v2.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.get_theta">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">get_theta</code><span class="sig-paren">(</span><em class="sig-param">v1</em>, <em class="sig-param">v2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#get_theta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.get_theta" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the angle in radians between two vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v1</strong> (<em>list</em>) – Vector 1.</p></li>
<li><p><strong>v2</strong> (<em>list</em>) – Vector 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The angle in radians between v1 and v2.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.get_torsion_angles">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">get_torsion_angles</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">conformers</em>, <em class="sig-param">torsions</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#get_torsion_angles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.get_torsion_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Populate each torsion pivots with all available angles from the generated conformers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>conformers</strong> (<em>list</em>) – The conformers from which to extract the angles.</p></li>
<li><p><strong>torsions</strong> (<em>list</em>) – The torsions to consider.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The torsion angles. Keys are torsion tuples, values are lists of all corresponding angles from conformers.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.get_vector">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">get_vector</code><span class="sig-paren">(</span><em class="sig-param">pivot</em>, <em class="sig-param">anchor</em>, <em class="sig-param">xyz</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#get_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.get_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a vector between two atoms in the molecule (pointing from pivot to anchor).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pivot</strong> (<em>int</em>) – The 0-index of the pivotal atom around which groups are to be translated.</p></li>
<li><p><strong>anchor</strong> (<em>int</em>) – The 0-index of an additional atom in the molecule.</p></li>
<li><p><strong>xyz</strong> (<em>dict</em>) – The 3D coordinates of the molecule with the same atom order as in mol.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A vector pointing from the pivotal atom towards the anchor atom.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.get_wells">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">get_wells</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">angles</em>, <em class="sig-param">blank=20</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#get_wells"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.get_wells" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the distinct wells from a list of angles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>angles</strong> (<em>list</em>) – The angles in the torsion.</p></li>
<li><p><strong>blank</strong> (<em>int</em><em>, </em><em>optional</em>) – The blank space between wells.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Entry are well dicts with keys: <code class="docutils literal notranslate"><span class="pre">start_idx</span></code>, <code class="docutils literal notranslate"><span class="pre">end_idx</span></code>, <code class="docutils literal notranslate"><span class="pre">start_angle</span></code>, <code class="docutils literal notranslate"><span class="pre">end_angle</span></code>, <code class="docutils literal notranslate"><span class="pre">angles</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.identify_chiral_centers">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">identify_chiral_centers</code><span class="sig-paren">(</span><em class="sig-param">mol</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#identify_chiral_centers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.identify_chiral_centers" title="Permalink to this definition">¶</a></dt>
<dd><p>Identify the atom indices corresponding to chiral centers in a molecule</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Molecule</em>) – The molecule to be analyzed.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Atom numbers (0-indexed) representing chiral centers in the molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.initialize_log">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">initialize_log</code><span class="sig-paren">(</span><em class="sig-param">verbose=20</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#initialize_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.initialize_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up a simple logger for stdout printing (not saving into as log file).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – Specify the amount of log text seen.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.mix_rdkit_and_openbabel_force_field">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">mix_rdkit_and_openbabel_force_field</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">mol</em>, <em class="sig-param">num_confs=None</em>, <em class="sig-param">xyz=None</em>, <em class="sig-param">force_field='GAFF'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#mix_rdkit_and_openbabel_force_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.mix_rdkit_and_openbabel_force_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimize conformers using a force field (GAFF, MMFF94s, MMFF94, UFF, Ghemical)
Use RDKit to generate the random conformers (open babel isn’t good enough),
but use open babel to optimize them (RDKit doesn’t have GAFF)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>mol</strong> (<em>Molecule</em><em>, </em><em>optional</em>) – The RMG molecule object with connectivity and bond order information.</p></li>
<li><p><strong>num_confs</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of random 3D conformations to generate.</p></li>
<li><p><strong>xyz</strong> (<em>string</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – The 3D coordinates in either a string or an array format.</p></li>
<li><p><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Entries are optimized xyz’s in a list format.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Entries are float numbers representing the energies in kJ/mol.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.openbabel_force_field">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">openbabel_force_field</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">mol</em>, <em class="sig-param">num_confs=None</em>, <em class="sig-param">xyz=None</em>, <em class="sig-param">force_field='GAFF'</em>, <em class="sig-param">method='diverse'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#openbabel_force_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.openbabel_force_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimize conformers using a force field (GAFF, MMFF94s, MMFF94, UFF, Ghemical)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>mol</strong> (<em>Molecule</em><em>, </em><em>optional</em>) – The RMG molecule object with connectivity and bond order information.</p></li>
<li><p><strong>num_confs</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of random 3D conformations to generate.</p></li>
<li><p><strong>xyz</strong> (<em>dict</em><em>, </em><em>optional</em>) – The 3D coordinates.</p></li>
<li><p><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use.</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – The conformer searching method to use in open babel.
For method description, see <a class="reference external" href="http://openbabel.org/dev-api/group__conformer.shtml">http://openbabel.org/dev-api/group__conformer.shtml</a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Entries are optimized xyz’s in a list format.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Entries are float numbers representing the energies in kJ/mol.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.rdkit_force_field">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">rdkit_force_field</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">rd_mol</em>, <em class="sig-param">rd_index_map=None</em>, <em class="sig-param">mol=None</em>, <em class="sig-param">force_field='MMFF94s'</em>, <em class="sig-param">optimize=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#rdkit_force_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.rdkit_force_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimize RDKit conformers using a force field (MMFF94 or MMFF94s are recommended).
Fallback to Open Babel if RDKit fails.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>rd_mol</strong> (<em>RDKit RDMol</em>) – The RDKit molecule with embedded conformers to optimize.</p></li>
<li><p><strong>rd_index_map</strong> (<em>list</em><em>, </em><em>optional</em>) – An atom map dictionary to reorder the xyz. Requires mol to not be None.</p></li>
<li><p><strong>mol</strong> (<em>Molecule</em><em>, </em><em>optional</em>) – The RMG molecule object with connectivity and bond order information.</p></li>
<li><p><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use.</p></li>
<li><p><strong>optimize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to first optimize the conformer using FF. True to optimize.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Entries are optimized xyz’s in a dictionary format.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Entries are float numbers representing the energies.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.read_rdkit_embedded_conformer_i">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">read_rdkit_embedded_conformer_i</code><span class="sig-paren">(</span><em class="sig-param">rd_mol</em>, <em class="sig-param">i</em>, <em class="sig-param">rd_index_map=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#read_rdkit_embedded_conformer_i"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.read_rdkit_embedded_conformer_i" title="Permalink to this definition">¶</a></dt>
<dd><p>Read coordinates from RDKit conformers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rd_mol</strong> (<em>RDKit RDMol</em>) – The RDKit molecule with embedded conformers to optimize.</p></li>
<li><p><strong>i</strong> (<em>int</em>) – The conformer index from rd_mol to read.</p></li>
<li><p><strong>rd_index_map</strong> (<em>list</em><em>, </em><em>optional</em>) – An atom map dictionary to reorder the xyz. Requires mol to not be None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>xyz coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.read_rdkit_embedded_conformers">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">read_rdkit_embedded_conformers</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">rd_mol</em>, <em class="sig-param">i=None</em>, <em class="sig-param">rd_index_map=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#read_rdkit_embedded_conformers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.read_rdkit_embedded_conformers" title="Permalink to this definition">¶</a></dt>
<dd><p>Read coordinates from RDKit conformers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>rd_mol</strong> (<em>RDKit RDMol</em>) – The RDKit molecule with embedded conformers to optimize.</p></li>
<li><p><strong>i</strong> (<em>int</em><em>, </em><em>optional</em>) – The conformer index from rd_mol to read. If None, all will be read,</p></li>
<li><p><strong>rd_index_map</strong> (<em>list</em><em>, </em><em>optional</em>) – An atom map dictionary to reorder the xyz. Requires mol to not be None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>entries are xyz coordinate dicts.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.rotate_vector">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">rotate_vector</code><span class="sig-paren">(</span><em class="sig-param">point_a</em>, <em class="sig-param">point_b</em>, <em class="sig-param">normal</em>, <em class="sig-param">theta</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#rotate_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.rotate_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate a vector in 3D space around a given axis by a certain angle.</p>
<p>Inspired by <a class="reference external" href="https://stackoverflow.com/questions/6802577/rotation-of-3d-vector">https://stackoverflow.com/questions/6802577/rotation-of-3d-vector</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point_a</strong> (<em>list</em>) – The 3D coordinates of the starting point (point A) of the vector to be rotated.</p></li>
<li><p><strong>point_b</strong> (<em>list</em>) – The 3D coordinates of the ending point (point B) of the vector to be rotated.</p></li>
<li><p><strong>normal</strong> (<em>list</em>) – The axis to be rotated around.</p></li>
<li><p><strong>theta</strong> (<em>float</em>) – The degree in radians by which to rotate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The rotated vector (the new coordinates for point B).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.to_group">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">to_group</code><span class="sig-paren">(</span><em class="sig-param">mol</em>, <em class="sig-param">atom_indices</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#to_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.to_group" title="Permalink to this definition">¶</a></dt>
<dd><p>This method converts a defined part of a Molecule into a Group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Molecule</em>) – The base molecule.</p></li>
<li><p><strong>atom_indices</strong> (<em>list</em>) – 0-indexed atom indices corresponding to atoms in mol to be included in the group.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A group consisting of the desired atoms in mol.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.translate_group">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">translate_group</code><span class="sig-paren">(</span><em class="sig-param">mol</em>, <em class="sig-param">xyz</em>, <em class="sig-param">pivot</em>, <em class="sig-param">anchor</em>, <em class="sig-param">vector</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#translate_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.translate_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate a group (a set of atoms from the pivot towards the anchor and onwards) by changing its
pivot -&gt; anchor vector to the desired new vector. Keep the relative distances between the group’s atoms constant,
as well as the distance between the anchor and the vector atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Molecule</em>) – The 2D graph representation of the molecule.</p></li>
<li><p><strong>xyz</strong> (<em>dict</em>) – The 3D coordinates of the molecule with the same atom order as in mol.</p></li>
<li><p><strong>pivot</strong> (<em>int</em>) – The 0-index of the pivotal atom around which groups are to be translated.</p></li>
<li><p><strong>anchor</strong> (<em>int</em>) – The 0-index of an anchor atom. The group is defined from the pivot atom to the anchor atom,
including all other atoms in the molecule connected to the anchor. The pivot and anchor
atoms should not have another path connecting them such as a ring.</p></li>
<li><p><strong>vector</strong> (<em>list</em>) – The new vector by which the group will be translated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The translated coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.translate_groups">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">translate_groups</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">mol</em>, <em class="sig-param">xyz</em>, <em class="sig-param">pivot</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#translate_groups"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.translate_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Exchange between two groups in a molecule. The groups cannot share a ring with the pivotal atom.
The function does not change the atom order, just the coordinates of atoms.
If the pivotal atom has exactly one lone pair, consider it as well as a dummy atom in translations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – The species’ label.</p></li>
<li><p><strong>mol</strong> (<em>Molecule</em>) – The 2D graph representation of the molecule.</p></li>
<li><p><strong>xyz</strong> (<em>dict</em>) – A string-format 3d coordinates of the molecule with the same atom order as in mol.</p></li>
<li><p><strong>pivot</strong> (<em>int</em>) – The 0-index of the pivotal atom around which groups are to be translated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The translated coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.unit_vector">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">unit_vector</code><span class="sig-paren">(</span><em class="sig-param">vector</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#unit_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.unit_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a unit vector in the same direction as the input vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vector</strong> (<em>list</em>) – The input vector.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The unit vector.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.update_mol">
<code class="sig-prename descclassname">arc.species.conformers.</code><code class="sig-name descname">update_mol</code><span class="sig-paren">(</span><em class="sig-param">mol</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#update_mol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.update_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Update atom types, multiplicity, and atom charges in the molecule.
<em>untested</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Molecule</em>) – The molecule to update.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Molecule</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="reaction.html" class="btn btn-neutral float-right" title="arc.reaction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="converter.html" class="btn btn-neutral float-left" title="arc.species.converter" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2019, Alon Grinberg Dana

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>