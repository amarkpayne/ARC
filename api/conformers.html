

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>arc.species.conformers &mdash; ARC 1.1.0 Documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="arc.reaction" href="reaction.html" />
    <link rel="prev" title="arc.species.converter" href="converter.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> ARC
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running.html">Running ARC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced.html">Advanced Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../output.html">Output</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ARC’s API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="main.html">arc.main</a></li>
<li class="toctree-l2"><a class="reference internal" href="species.html">arc.species.species</a></li>
<li class="toctree-l2"><a class="reference internal" href="converter.html">arc.species.converter</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">arc.species.conformers</a></li>
<li class="toctree-l2"><a class="reference internal" href="reaction.html">arc.reaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="scheduler.html">arc.scheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="job.html">arc.job.job</a></li>
<li class="toctree-l2"><a class="reference internal" href="ssh.html">arc.job.ssh</a></li>
<li class="toctree-l2"><a class="reference internal" href="local.html">arc.job.local</a></li>
<li class="toctree-l2"><a class="reference internal" href="parser.html">arc.parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="plotter.html">arc.plotter</a></li>
<li class="toctree-l2"><a class="reference internal" href="processor.html">arc.processor</a></li>
<li class="toctree-l2"><a class="reference internal" href="rmgdb.html">arc.rmgdb</a></li>
<li class="toctree-l2"><a class="reference internal" href="common.html">arc.common</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">Standalone tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">How to cite ARC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../licence.html">Licence</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ARC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">ARC’s API</a> &raquo;</li>
        
      <li>arc.species.conformers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/conformers.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-arc.species.conformers">
<span id="arc-species-conformers"></span><span id="conformers"></span><h1>arc.species.conformers<a class="headerlink" href="#module-arc.species.conformers" title="Permalink to this headline">¶</a></h1>
<p>A module for (non-TS) species conformer generation</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">variables that contain atom indices such as torsions and tops are 1-indexed,
while atoms in Molecules are 0-indexed.</p>
</div>
<dl class="function">
<dt id="arc.species.conformers.calculate_dihedral_angle">
<code class="descclassname">arc.species.conformers.</code><code class="descname">calculate_dihedral_angle</code><span class="sig-paren">(</span><em>coord</em>, <em>torsion</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#calculate_dihedral_angle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.calculate_dihedral_angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a dihedral angle. Inspired by ASE Atoms.get_dihedral().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>coord</strong> (<em>list</em>) – The array-format coordinates.</li>
<li><strong>torsion</strong> (<em>list</em>) – The 4 atoms defining the dihedral angle.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The dihedral angle.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.change_dihedrals_and_force_field_it">
<code class="descclassname">arc.species.conformers.</code><code class="descname">change_dihedrals_and_force_field_it</code><span class="sig-paren">(</span><em>label</em>, <em>mol</em>, <em>xyz</em>, <em>torsions</em>, <em>new_dihedrals</em>, <em>optimize=True</em>, <em>return_xyz_strings=True</em>, <em>force_field=u'MMFF94'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#change_dihedrals_and_force_field_it"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.change_dihedrals_and_force_field_it" title="Permalink to this definition">¶</a></dt>
<dd><p>Change dihedrals of specified torsions according to the new dihedrals specified, and get FF energies.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">torsions</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">new_dihedrals</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">120</span><span class="p">],</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span> <span class="p">[</span><span class="mi">180</span><span class="p">,</span> <span class="mi">270</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">270</span><span class="p">]]</span>
</pre></div>
</div>
<p>This will calculate the energy of the original conformer (defined using <cite>xyz</cite>).
We iterate through new_dihedrals. The torsions are set accordingly and the energy and xyz of the newly
generated conformer are kept.</p>
<p>We assume that each list entry in new_dihedrals is of the length of the torsions list (2 in the example).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>mol</strong> (<em>Molecule</em>) – The RMG molecule with the connectivity information.</li>
<li><strong>xyz</strong> (<em>str</em><em>, or </em><em>list</em>) – The base 3D geometry to be changed, in either string or array format.</li>
<li><strong>torsions</strong> (<em>list</em>) – Entries are torsion tuples for which the dihedral will be changed relative to xyz.</li>
<li><strong>new_dihedrals</strong> (<em>list</em>) – Entries are same size lists of dihedral angles (floats) corresponding to the torsions.</li>
<li><strong>optimize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to optimize the coordinates using FF. True to optimize.</li>
<li><strong>return_xyz_strings</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return xyz in string or array format. True for string.</li>
<li><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The conformer FF energies corresponding to the list of dihedrals.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">list</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The conformer xyz geometries corresponding to the list of dihedrals.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.check_atom_collisions">
<code class="descclassname">arc.species.conformers.</code><code class="descname">check_atom_collisions</code><span class="sig-paren">(</span><em>xyz</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#check_atom_collisions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.check_atom_collisions" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether atoms are too close to each other.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>xyz</strong> (<em>str</em>) – The 3D geometry.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True if they are colliding, False otherwise.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.check_special_non_rotor_cases">
<code class="descclassname">arc.species.conformers.</code><code class="descname">check_special_non_rotor_cases</code><span class="sig-paren">(</span><em>mol</em>, <em>top1</em>, <em>top2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#check_special_non_rotor_cases"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.check_special_non_rotor_cases" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether one of the tops correspond to a special case which could not be rotated
<cite>mol</cite> is the RMG Molecule to diagnose
<cite>top1</cite> and <cite>top2</cite> are indices of atoms on each side of the pivots, the first index corresponds to one of the pivots</p>
<p>Special cases considered are:</p>
<ul class="simple">
<li>cyano groups: <code class="docutils literal notranslate"><span class="pre">R-C#N</span></code></li>
<li>azide groups: <code class="docutils literal notranslate"><span class="pre">N-N#N</span></code></li>
</ul>
<p>These cases have a 180 degree angle and torsion is meaningless, but they are identified by our methods since they
have a single bond
Returns <cite>True</cite> if this is indeed a special case which should not be treated as a rotor</p>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.compare_xyz">
<code class="descclassname">arc.species.conformers.</code><code class="descname">compare_xyz</code><span class="sig-paren">(</span><em>xyz1</em>, <em>xyz2</em>, <em>precision=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#compare_xyz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.compare_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare coordinates of two conformers of the same species</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xyz1</strong> (<em>list</em><em>, </em><em>str</em>) – Coordinates of conformer 1 in either string or array format.</li>
<li><strong>xyz2</strong> (<em>list</em><em>, </em><em>str</em>) – Coordinates of conformer 2 in either string or array format.</li>
<li><strong>precision</strong> (<em>float</em><em>, </em><em>optional</em>) – The allowed difference threshold between coordinates, in Angstroms.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Whether the coordinates represent the same conformer, True if they do.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.conformers_combinations_by_lowest_conformer">
<code class="descclassname">arc.species.conformers.</code><code class="descname">conformers_combinations_by_lowest_conformer</code><span class="sig-paren">(</span><em>label</em>, <em>mol</em>, <em>base_xyz</em>, <em>multiple_tors</em>, <em>multiple_sampling_points</em>, <em>len_conformers=-1</em>, <em>force_field=u'MMFF94'</em>, <em>max_combination_iterations=25</em>, <em>torsion_angles=None</em>, <em>multiple_sampling_points_dict=None</em>, <em>wells_dict=None</em>, <em>de_threshold=None</em>, <em>plot_path=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#conformers_combinations_by_lowest_conformer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.conformers_combinations_by_lowest_conformer" title="Permalink to this definition">¶</a></dt>
<dd><p>Iteratively modify dihedrals in the lowest conformer (each iteration deduce the new lowest conformer),
until convergence.
untested</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>mol</strong> (<em>Molecule</em>) – The RMG molecule with the connectivity information.</li>
<li><strong>base_xyz</strong> (<em>str</em><em>, or </em><em>list</em>) – The base 3D geometry to be changed, in either string or array format.</li>
<li><strong>multiple_tors</strong> (<em>list</em>) – Entries are torsion tuples of non-symmetric torsions.</li>
<li><strong>multiple_sampling_points</strong> (<em>list</em>) – Entries are lists of dihedral angles (sampling points), respectively correspond
to torsions in multiple_tors.</li>
<li><strong>len_conformers</strong> (<em>int</em><em>, </em><em>optional</em>) – The length of the existing conformers list (for consecutive numbering).</li>
<li><strong>de_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – An energy threshold (in kJ/mol) above which wells in a torsion
will not be considered.</li>
<li><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use.</li>
<li><strong>max_combination_iterations</strong> (<em>int</em><em>, </em><em>optional</em>) – The max num of times to iteratively search for the lowest conformer.</li>
<li><strong>torsion_angles</strong> (<em>dict</em><em>, </em><em>optional</em>) – The torsion angles. Keys are torsion tuples, values are lists of all
corresponding angles from conformers.</li>
<li><strong>multiple_sampling_points_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keys are torsion tuples, values are respective sampling points.</li>
<li><strong>wells_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keys are torsion tuples, values are well dictionaries.</li>
<li><strong>plot_path</strong> (<em>str</em><em>, </em><em>optional</em>) – A folder path in which the plot will be saved.
If None, the plot will not be shown (nor saved).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">New conformer combinations, entries are conformer dictionaries.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.deduce_new_conformers">
<code class="descclassname">arc.species.conformers.</code><code class="descname">deduce_new_conformers</code><span class="sig-paren">(</span><em>label</em>, <em>conformers</em>, <em>torsions</em>, <em>tops</em>, <em>mol_list</em>, <em>smeared_scan_res=None</em>, <em>plot_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#deduce_new_conformers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.deduce_new_conformers" title="Permalink to this definition">¶</a></dt>
<dd><p>By knowing the existing torsion wells, get the geometries of all important conformers.
Validate that atoms don’t collide in the generated conformers (don’t consider ones where they do).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>conformers</strong> (<em>list</em>) – Entries are conformer dictionaries.</li>
<li><strong>torsions</strong> (<em>list</em>) – A list of all possible torsion angles in the molecule, each torsion angles list is sorted.</li>
<li><strong>tops</strong> (<em>list</em>) – A list of tops corresponding to torsions.</li>
<li><strong>mol_list</strong> (<em>list</em>) – A list of RMG Molecule objects.</li>
<li><strong>smeared_scan_res</strong> (<em>float</em><em>, </em><em>optional</em>) – The resolution (in degrees) for scanning smeared wells.</li>
<li><strong>plot_path</strong> (<em>str</em><em>, </em><em>optional</em>) – A folder path in which the plot will be saved.
If None, the plot will not be shown (nor saved).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">many inter-level variables.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.determine_dihedrals">
<code class="descclassname">arc.species.conformers.</code><code class="descname">determine_dihedrals</code><span class="sig-paren">(</span><em>conformers</em>, <em>torsions</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#determine_dihedrals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.determine_dihedrals" title="Permalink to this definition">¶</a></dt>
<dd><p>For each conformer in <cite>conformers</cite> determine the respective dihedrals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>conformers</strong> (<em>list</em>) – Entries are conformer dictionaries.</li>
<li><strong>torsions</strong> (<em>list</em>) – All possible torsions in the molecule.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Entries are conformer dictionaries.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.determine_number_of_conformers_to_generate">
<code class="descclassname">arc.species.conformers.</code><code class="descname">determine_number_of_conformers_to_generate</code><span class="sig-paren">(</span><em>label</em>, <em>heavy_atoms</em>, <em>torsion_num</em>, <em>minimalist=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#determine_number_of_conformers_to_generate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.determine_number_of_conformers_to_generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the number of conformers to generate using molecular mechanics</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>heavy_atoms</strong> (<em>int</em>) – The number of heavy atoms in the molecule.</li>
<li><strong>torsion_num</strong> (<em>int</em>) – The number of potential torsions in the molecule.</li>
<li><strong>minimalist</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return a small number of conformers, useful when this is just a guess
before fitting a force field. True to be minimalistic.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">number of conformers to generate.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">int</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ConformerError</span></code> – If the number of conformers to generate cannot be determined.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.determine_rotors">
<code class="descclassname">arc.species.conformers.</code><code class="descname">determine_rotors</code><span class="sig-paren">(</span><em>mol_list</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#determine_rotors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.determine_rotors" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine possible unique rotors in the species to be treated as hindered rotors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mol_list</strong> (<em>list</em>) – Localized structures (Molecule objects) by which all rotors will be determined.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A list of indices of scan pivots.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A list of indices of top atoms (including one of the pivotal atoms) corresponding to the torsions.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.determine_top_group_indices">
<code class="descclassname">arc.species.conformers.</code><code class="descname">determine_top_group_indices</code><span class="sig-paren">(</span><em>mol</em>, <em>atom1</em>, <em>atom2</em>, <em>index=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#determine_top_group_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.determine_top_group_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the indices of a “top group” in a molecule.
The top is defined as all atoms connected to atom2, including atom2, excluding the direction of atom1.
Two <code class="docutils literal notranslate"><span class="pre">atom_list_to_explore</span></code> are used so the list the loop iterates through isn’t changed within the loop.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mol</strong> (<em>Molecule</em>) – The Molecule object to explore.</li>
<li><strong>atom1</strong> (<em>Atom</em>) – The pivotal atom in mol.</li>
<li><strong>atom2</strong> (<em>Atom</em>) – The beginning of the top relative to atom1 in mol.</li>
<li><strong>index</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return 1-index or 0-index conventions. 1 for 1-index.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The indices of the atoms in the top (either 0-index or 1-index, as requested).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">list</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Whether the top has heavy atoms (is not just a hydrogen atom). True if it has heavy atoms.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.determine_torsion_sampling_points">
<code class="descclassname">arc.species.conformers.</code><code class="descname">determine_torsion_sampling_points</code><span class="sig-paren">(</span><em>label</em>, <em>torsion_angles</em>, <em>smeared_scan_res=None</em>, <em>symmetry=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#determine_torsion_sampling_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.determine_torsion_sampling_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine how many points to consider in each well of a torsion for conformer combinations</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>torsion_angles</strong> (<em>list</em>) – Well angles in the torsion.</li>
<li><strong>smeared_scan_res</strong> (<em>float</em><em>, </em><em>optional</em>) – The resolution (in degrees) for scanning smeared wells.</li>
<li><strong>symmetry</strong> (<em>int</em><em>, </em><em>optional</em>) – The torsion symmetry number.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Sampling points for the torsion.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">list</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Each entry is a well dictionary with the keys
<code class="docutils literal notranslate"><span class="pre">start_idx</span></code>, <code class="docutils literal notranslate"><span class="pre">end_idx</span></code>, <code class="docutils literal notranslate"><span class="pre">start_angle</span></code>, <code class="docutils literal notranslate"><span class="pre">end_angle</span></code>, <code class="docutils literal notranslate"><span class="pre">angles</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.determine_torsion_symmetry">
<code class="descclassname">arc.species.conformers.</code><code class="descname">determine_torsion_symmetry</code><span class="sig-paren">(</span><em>label</em>, <em>top1</em>, <em>mol_list</em>, <em>torsion_scan</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#determine_torsion_symmetry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.determine_torsion_symmetry" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether a torsion is symmetric.</p>
<p>If a torsion well is “well defined” and not smeared, it could be symmetric.
Check the groups attached to the rotor pivots to determine whether it is indeed symmetric
We don’t care about the actual rotor symmetry number here, since we plan to just use the first well
(they’re all the same).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>top1</strong> (<em>list</em>) – A list of atom indices on one side of the torsion, including the pivotal atom.</li>
<li><strong>mol_list</strong> (<em>list</em>) – A list of molecules.</li>
<li><strong>torsion_scan</strong> (<em>list</em>) – The angles corresponding to this torsion from all conformers.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The rotor symmetry number.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.determine_well_width_tolerance">
<code class="descclassname">arc.species.conformers.</code><code class="descname">determine_well_width_tolerance</code><span class="sig-paren">(</span><em>mean_width</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#determine_well_width_tolerance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.determine_well_width_tolerance" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the tolerance by which well widths are determined to be nearly equal.</p>
<p>Fitted to a polynomial trend line for the following data of (mean, tolerance) pairs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">),</span> <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">),</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">),</span> <span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.59</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mean_width</strong> (<em>float</em>) – The mean well width in degrees.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The tolerance.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.embed_rdkit">
<code class="descclassname">arc.species.conformers.</code><code class="descname">embed_rdkit</code><span class="sig-paren">(</span><em>label</em>, <em>mol</em>, <em>num_confs=None</em>, <em>xyz=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#embed_rdkit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.embed_rdkit" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate random conformers (unoptimized) in RDKit</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>mol</strong> (<em>RMG Molecule</em><em> or </em><em>RDKit RDMol</em>) – The molecule object with connectivity and bond order information.</li>
<li><strong>num_confs</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of random 3D conformations to generate.</li>
<li><strong>xyz</strong> (<em>string</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – The 3D coordinates in either a string or an array format.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An RDKIt molecule with embedded conformers.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">RDMol</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The atom mapping dictionary.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.find_internal_rotors">
<code class="descclassname">arc.species.conformers.</code><code class="descname">find_internal_rotors</code><span class="sig-paren">(</span><em>mol</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#find_internal_rotors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.find_internal_rotors" title="Permalink to this definition">¶</a></dt>
<dd><p>Locates the sets of indices corresponding to every internal rotor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mol</strong> (<em>Molecule</em>) – The molecule for which rotors will be determined</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">All rotor dictionaries with the gaussian scan coordinates, the pivots and the smallest top.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.generate_all_combinations">
<code class="descclassname">arc.species.conformers.</code><code class="descname">generate_all_combinations</code><span class="sig-paren">(</span><em>label</em>, <em>mol</em>, <em>base_xyz</em>, <em>multiple_tors</em>, <em>multiple_sampling_points</em>, <em>len_conformers=-1</em>, <em>force_field=u'MMFF94'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#generate_all_combinations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.generate_all_combinations" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate all combinations of torsion wells from a base conformer.
untested</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>mol</strong> (<em>Molecule</em>) – The RMG molecule with the connectivity information.</li>
<li><strong>base_xyz</strong> (<em>str</em><em>, or </em><em>list</em>) – The base 3D geometry to be changed, in either string or array format.</li>
<li><strong>multiple_tors</strong> (<em>list</em>) – Entries are torsion tuples of non-symmetric torsions.</li>
<li><strong>multiple_sampling_points</strong> (<em>list</em>) – Entries are lists of dihedral angles (sampling points), respectively correspond
to torsions in multiple_tors.</li>
<li><strong>len_conformers</strong> (<em>int</em><em>, </em><em>optional</em>) – The length of the existing conformers list (for consecutive numbering).</li>
<li><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">New conformer combinations, entries are conformer dictionaries.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.generate_all_enantiomers">
<code class="descclassname">arc.species.conformers.</code><code class="descname">generate_all_enantiomers</code><span class="sig-paren">(</span><em>label</em>, <em>mol</em>, <em>xyz</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#generate_all_enantiomers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.generate_all_enantiomers" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate all combinations of enantiomers for a given conformer’s coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>mol</strong> (<em>Molecule</em>) – The 2D graph representation of the molecule.</li>
<li><strong>xyz</strong> (<em>str</em>) – A string-format 3d coordinates of the molecule with the same atom order as in mol.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A list of string-format coordinates of all enantiomer combinations.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.generate_conformer_combinations">
<code class="descclassname">arc.species.conformers.</code><code class="descname">generate_conformer_combinations</code><span class="sig-paren">(</span><em>label</em>, <em>mol</em>, <em>base_xyz</em>, <em>hypothetical_num_comb</em>, <em>multiple_tors</em>, <em>multiple_sampling_points</em>, <em>combination_threshold=1000</em>, <em>len_conformers=-1</em>, <em>force_field=u'MMFF94'</em>, <em>max_combination_iterations=25</em>, <em>plot_path=None</em>, <em>torsion_angles=None</em>, <em>multiple_sampling_points_dict=None</em>, <em>wells_dict=None</em>, <em>de_threshold=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#generate_conformer_combinations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.generate_conformer_combinations" title="Permalink to this definition">¶</a></dt>
<dd><p>Call either conformers_combinations_by_lowest_conformer() or generate_all_combinations(),
according to the hypothetical_num_comb.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>mol</strong> (<em>Molecule</em>) – The RMG molecule with the connectivity information.</li>
<li><strong>base_xyz</strong> (<em>str</em><em>, or </em><em>list</em>) – The base 3D geometry to be changed, in either string or array format.</li>
<li><strong>hypothetical_num_comb</strong> (<em>int</em>) – The number of combinations that could be generated by changing dihedrals,
considering symmetry but not considering atom collisions.</li>
<li><strong>combination_threshold</strong> (<em>int</em><em>, </em><em>optional</em>) – A threshold below which all combinations will be generated.</li>
<li><strong>multiple_tors</strong> (<em>list</em>) – Entries are torsion tuples of non-symmetric torsions.</li>
<li><strong>multiple_sampling_points</strong> (<em>list</em>) – Entries are lists of dihedral angles (sampling points), respectively correspond
to torsions in multiple_tors.</li>
<li><strong>len_conformers</strong> (<em>int</em><em>, </em><em>optional</em>) – The length of the existing conformers list (for consecutive numbering).</li>
<li><strong>de_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – An energy threshold (in kJ/mol) above which wells in a torsion
will not be considered.</li>
<li><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use.</li>
<li><strong>max_combination_iterations</strong> (<em>int</em><em>, </em><em>optional</em>) – The max num of times to iteratively search for the lowest conformer.</li>
<li><strong>torsion_angles</strong> (<em>dict</em><em>, </em><em>optional</em>) – The torsion angles. Keys are torsion tuples, values are lists of all
corresponding angles from conformers.</li>
<li><strong>multiple_sampling_points_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keys are torsion tuples, values are respective sampling points.</li>
<li><strong>wells_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keys are torsion tuples, values are well dictionaries.</li>
<li><strong>plot_path</strong> (<em>str</em><em>, </em><em>optional</em>) – A folder path in which the plot will be saved.
If None, the plot will not be shown (nor saved).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">New conformer combinations, entries are conformer dictionaries.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.generate_conformers">
<code class="descclassname">arc.species.conformers.</code><code class="descname">generate_conformers</code><span class="sig-paren">(</span><em>mol_list</em>, <em>label</em>, <em>xyzs=None</em>, <em>torsions=None</em>, <em>tops=None</em>, <em>charge=0</em>, <em>multiplicity=None</em>, <em>num_confs=None</em>, <em>num_confs_to_return=None</em>, <em>well_tolerance=None</em>, <em>de_threshold=None</em>, <em>smeared_scan_res=None</em>, <em>combination_threshold=None</em>, <em>force_field=u'MMFF94'</em>, <em>max_combination_iterations=None</em>, <em>determine_h_bonds=False</em>, <em>return_all_conformers=False</em>, <em>plot_path=None</em>, <em>print_logs=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#generate_conformers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.generate_conformers" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate conformers for (non-TS) species starting from a list of RMG Molecules.
(resonance structures are assumed to have already been generated and included in the molecule list)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mol_list</strong> (<em>list</em><em> or </em><em>Molecule</em>) – Molecule objects to consider (or Molecule, resonance structures will be generated).</li>
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>xyzs</strong> (<em>list</em>) – A list of user guess xyzs, each in string format, that will also be taken into account.</li>
<li><strong>torsions</strong> (<em>list</em><em>, </em><em>optional</em>) – A list of all possible torsions in the molecule. Will be determined if not given.</li>
<li><strong>tops</strong> (<em>list</em><em>, </em><em>optional</em>) – A list of tops corresponding to torsions. Will be determined if not given.</li>
<li><strong>charge</strong> (<em>int</em><em>, </em><em>optional</em>) – The species charge. Used to perceive a molecule from xyz.</li>
<li><strong>multiplicity</strong> (<em>int</em><em>, </em><em>optional</em>) – The species multiplicity. Used to perceive a molecule from xyz.</li>
<li><strong>num_confs</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of conformers to generate. Determined automatically if not given.</li>
<li><strong>num_confs_to_return</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of conformers to return.</li>
<li><strong>well_tolerance</strong> (<em>float</em><em>, </em><em>optional</em>) – The required precision (in degrees) around which to center a well’s mean.</li>
<li><strong>de_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Energy threshold (in kJ/mol) above which wells will not be considered.</li>
<li><strong>smeared_scan_res</strong> (<em>float</em><em>, </em><em>optional</em>) – The resolution (in degrees) for scanning smeared wells.</li>
<li><strong>combination_threshold</strong> (<em>int</em><em>, </em><em>optional</em>) – A threshold below which all combinations will be generated.</li>
<li><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use (MMFF94, MMFF94s, UFF, GAFF, fit).
‘fit’ will first run MMFF94, than fit a custom Amber FF to the species.</li>
<li><strong>max_combination_iterations</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of times to iteratively search
for the lowest conformer.</li>
<li><strong>determine_h_bonds</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to determine add. conformers w/ hydrogen bonds from the lowest one.</li>
<li><strong>return_all_conformers</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the full conformers list of conformer dictionaries
In addition to the lowest conformers list. Tru to return it.</li>
<li><strong>plot_path</strong> (<em>str</em><em>, </em><em>optional</em>) – A folder path in which the plot will be saved.
If None, the plot will not be shown (nor saved).</li>
<li><strong>print_logs</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether define a logger so logs are also printed to stdout.
Useful when run outside of ARC. True to print.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Lowest conformers (number of entries is num_confs_to_return times the number of enantiomer combinations)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">list</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ConformerError</span></code> – If something goes wrong.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.generate_force_field_conformers">
<code class="descclassname">arc.species.conformers.</code><code class="descname">generate_force_field_conformers</code><span class="sig-paren">(</span><em>label</em>, <em>mol_list</em>, <em>torsion_num</em>, <em>charge</em>, <em>multiplicity</em>, <em>xyzs=None</em>, <em>num_confs=None</em>, <em>force_field=u'MMFF94'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#generate_force_field_conformers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.generate_force_field_conformers" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate conformers using RDKit and Open Babel and optimize them using a force field
Also consider user guesses in <cite>xyzs</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>mol_list</strong> (<em>list</em>) – Entries are Molecule objects representing resonance structures of a chemical species.</li>
<li><strong>xyzs</strong> (<em>list</em><em>, </em><em>optional</em>) – Entries are xyz coordinates in string format, given as initial guesses.</li>
<li><strong>torsion_num</strong> (<em>int</em>) – The number of torsions identified in the molecule.</li>
<li><strong>charge</strong> (<em>int</em>) – The net charge of the species.</li>
<li><strong>multiplicity</strong> (<em>int</em>) – The species spin multiplicity.</li>
<li><strong>num_confs</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of conformers to generate.</li>
<li><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Entries are conformer dictionaries.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">list</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ConformerError</span></code> – If xyzs is given and it is not a list, or its entries are not strings.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.get_force_field_energies">
<code class="descclassname">arc.species.conformers.</code><code class="descname">get_force_field_energies</code><span class="sig-paren">(</span><em>label</em>, <em>mol</em>, <em>num_confs=None</em>, <em>xyz=None</em>, <em>force_field=u'MMFF94'</em>, <em>return_xyz_strings=True</em>, <em>optimize=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#get_force_field_energies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.get_force_field_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine force field energies using RDKit.
If num_confs is given, random 3D geometries will be generated. If xyz is given, it will be directly used instead.
The coordinates are returned in the order of atoms in mol.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>mol</strong> (<em>Molecule</em>) – The RMG molecule object with connectivity and bond order information.</li>
<li><strong>num_confs</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of random 3D conformations to generate.</li>
<li><strong>xyz</strong> (<em>string</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – A 3D coordinates guess in either a string or an array format.</li>
<li><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use.</li>
<li><strong>return_xyz_strings</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return xyz in string or array format. True for string.</li>
<li><strong>optimize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to first optimize the conformer using FF. True to optimize.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Entries are xyz coordinates.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">list</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Entries are the FF energies (in kJ/mol).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.get_lowest_confs">
<code class="descclassname">arc.species.conformers.</code><code class="descname">get_lowest_confs</code><span class="sig-paren">(</span><em>label</em>, <em>confs</em>, <em>n=1</em>, <em>energy=u'FF energy'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#get_lowest_confs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.get_lowest_confs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the most stable conformer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>confs</strong> (<em>list</em>) – Entries are either conformer dictionaries or a length two list of xyz coordinates and energy.</li>
<li><strong>n</strong> (<em>int</em>) – Number of lowest conformers to return.</li>
<li><strong>energy</strong> (<em>str</em><em>, </em><em>optional</em>) – The energy attribute to search by. Currently only ‘FF energy’ is supported.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Conformer dictionaries.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.get_lp_vector">
<code class="descclassname">arc.species.conformers.</code><code class="descname">get_lp_vector</code><span class="sig-paren">(</span><em>label</em>, <em>mol</em>, <em>xyz</em>, <em>pivot</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#get_lp_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.get_lp_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a vector from the pivotal atom in the molecule towards its lone electron pairs.
The approach is to reverse the average of the three unit vectors between the pivotal atom and its neighbors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>mol</strong> (<em>Molecule</em>) – The 2D graph representation of the molecule.</li>
<li><strong>xyz</strong> (<em>str</em>) – A string-format 3d coordinates of the molecule with the same atom order as in mol.</li>
<li><strong>pivot</strong> (<em>int</em>) – The 0-index of the pivotal atom around which groups are to be translated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A vector pointing from the pivotal atom towards its lone electron pairs orbital.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.get_normal">
<code class="descclassname">arc.species.conformers.</code><code class="descname">get_normal</code><span class="sig-paren">(</span><em>v1</em>, <em>v2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#get_normal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.get_normal" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a normal vector using cross multiplication.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>v1</strong> (<em>list</em>) – Vector 1.</li>
<li><strong>v2</strong> (<em>list</em>) – Vector 2.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A normal unit vector to v1 and v2.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.get_theta">
<code class="descclassname">arc.species.conformers.</code><code class="descname">get_theta</code><span class="sig-paren">(</span><em>v1</em>, <em>v2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#get_theta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.get_theta" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the angle in radians between two vectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>v1</strong> (<em>list</em>) – Vector 1.</li>
<li><strong>v2</strong> (<em>list</em>) – Vector 2.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The angle in radians between v1 and v2.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.get_torsion_angles">
<code class="descclassname">arc.species.conformers.</code><code class="descname">get_torsion_angles</code><span class="sig-paren">(</span><em>label</em>, <em>conformers</em>, <em>torsions</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#get_torsion_angles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.get_torsion_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Populate each torsion pivots with all available angles from the generated conformers</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>conformers</strong> (<em>list</em>) – The conformers from which to extract the angles.</li>
<li><strong>torsions</strong> (<em>list</em>) – The torsions to consider.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The torsion angles. Keys are torsion tuples, values are lists of all corresponding angles from conformers.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.get_vector">
<code class="descclassname">arc.species.conformers.</code><code class="descname">get_vector</code><span class="sig-paren">(</span><em>pivot</em>, <em>anchor</em>, <em>xyz</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#get_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.get_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a vector between two atoms in the molecule (pointing from pivot to anchor).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pivot</strong> (<em>int</em>) – The 0-index of the pivotal atom around which groups are to be translated.</li>
<li><strong>anchor</strong> (<em>int</em>) – The 0-index of an additional atom in the molecule.</li>
<li><strong>xyz</strong> (<em>str</em>) – A string-format 3d coordinates of the molecule with the same atom order as in mol.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A vector pointing from the pivotal atom towards the anchor atom.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.get_wells">
<code class="descclassname">arc.species.conformers.</code><code class="descname">get_wells</code><span class="sig-paren">(</span><em>label</em>, <em>angles</em>, <em>blank=20</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#get_wells"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.get_wells" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the distinct wells from a list of angles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>angles</strong> (<em>list</em>) – The angles in the torsion.</li>
<li><strong>blank</strong> (<em>int</em><em>, </em><em>optional</em>) – The blank space between wells.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Each entry is a well dictionary with the keys: <code class="docutils literal notranslate"><span class="pre">start_idx</span></code>, <code class="docutils literal notranslate"><span class="pre">end_idx</span></code>, <code class="docutils literal notranslate"><span class="pre">start_angle</span></code>, <code class="docutils literal notranslate"><span class="pre">end_angle</span></code>,
<code class="docutils literal notranslate"><span class="pre">angles</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.identify_chiral_centers">
<code class="descclassname">arc.species.conformers.</code><code class="descname">identify_chiral_centers</code><span class="sig-paren">(</span><em>mol</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#identify_chiral_centers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.identify_chiral_centers" title="Permalink to this definition">¶</a></dt>
<dd><p>Identify the atom indices corresponding to chiral centers in a molecule</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mol</strong> (<em>Molecule</em>) – The molecule to be analyzed.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Atom numbers (0-indexed) representing chiral centers in the molecule.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.initialize_log">
<code class="descclassname">arc.species.conformers.</code><code class="descname">initialize_log</code><span class="sig-paren">(</span><em>verbose=20</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#initialize_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.initialize_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up a simple logger for stdout printing (not saving into as log file).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – Specify the amount of log text seen.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.mix_rdkit_and_openbabel_force_field">
<code class="descclassname">arc.species.conformers.</code><code class="descname">mix_rdkit_and_openbabel_force_field</code><span class="sig-paren">(</span><em>label</em>, <em>mol</em>, <em>num_confs=None</em>, <em>xyz=None</em>, <em>force_field=u'GAFF'</em>, <em>return_xyz_strings=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#mix_rdkit_and_openbabel_force_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.mix_rdkit_and_openbabel_force_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimize conformers using a force field (GAFF, MMFF94s, MMFF94, UFF, Ghemical)
Use RDKit to generate the random conformers (open babel isn’t good enough),
but use open babel to optimize them (RDKit doesn’t have GAFF)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>mol</strong> (<em>Molecule</em><em>, </em><em>optional</em>) – The RMG molecule object with connectivity and bond order information.</li>
<li><strong>num_confs</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of random 3D conformations to generate.</li>
<li><strong>xyz</strong> (<em>string</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – The 3D coordinates in either a string or an array format.</li>
<li><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use.</li>
<li><strong>return_xyz_strings</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return xyz in string or array format. True for string.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Entries are optimized xyz’s in a list format.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">list</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Entries are float numbers representing the energies in kJ/mol.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.openbabel_force_field">
<code class="descclassname">arc.species.conformers.</code><code class="descname">openbabel_force_field</code><span class="sig-paren">(</span><em>label</em>, <em>mol</em>, <em>num_confs=None</em>, <em>xyz=None</em>, <em>force_field=u'GAFF'</em>, <em>return_xyz_strings=True</em>, <em>method=u'diverse'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#openbabel_force_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.openbabel_force_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimize conformers using a force field (GAFF, MMFF94s, MMFF94, UFF, Ghemical)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>mol</strong> (<em>Molecule</em><em>, </em><em>optional</em>) – The RMG molecule object with connectivity and bond order information.</li>
<li><strong>num_confs</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of random 3D conformations to generate.</li>
<li><strong>xyz</strong> (<em>list</em><em>, </em><em>optional</em>) – The 3D coordinates in an array format.</li>
<li><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use.</li>
<li><strong>return_xyz_strings</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return xyz in string or array format. True for string.</li>
<li><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – The conformer searching method to use in open babel.
For method description, see <a class="reference external" href="http://openbabel.org/dev-api/group__conformer.shtml">http://openbabel.org/dev-api/group__conformer.shtml</a></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Entries are optimized xyz’s in a list format.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">list</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Entries are float numbers representing the energies in kJ/mol.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.rdkit_force_field">
<code class="descclassname">arc.species.conformers.</code><code class="descname">rdkit_force_field</code><span class="sig-paren">(</span><em>label</em>, <em>rd_mol</em>, <em>rd_index_map=None</em>, <em>mol=None</em>, <em>force_field=u'MMFF94'</em>, <em>return_xyz_strings=True</em>, <em>optimize=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#rdkit_force_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.rdkit_force_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimize RDKit conformers using a force field (MMFF94 or MMFF94s are recommended).
Fallback to Open Babel if RDKit fails.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>rd_mol</strong> (<em>RDKit RDMol</em>) – The RDKit molecule with embedded conformers to optimize.</li>
<li><strong>rd_index_map</strong> (<em>list</em><em>, </em><em>optional</em>) – An atom map dictionary to reorder the xyz. Requires mol to not be None.</li>
<li><strong>mol</strong> (<em>Molecule</em><em>, </em><em>optional</em>) – The RMG molecule object with connectivity and bond order information.</li>
<li><strong>force_field</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of force field to use.</li>
<li><strong>return_xyz_strings</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return xyz in string or array format. True for string.
Requires mol to not be None to return string format.</li>
<li><strong>optimize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to first optimize the conformer using FF. True to optimize.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Entries are optimized xyz’s in the desired format.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">list</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Entries are float numbers representing the energies.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.read_rdkit_embedded_conformer_i">
<code class="descclassname">arc.species.conformers.</code><code class="descname">read_rdkit_embedded_conformer_i</code><span class="sig-paren">(</span><em>rd_mol</em>, <em>i</em>, <em>rd_index_map=None</em>, <em>mol=None</em>, <em>return_xyz_strings=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#read_rdkit_embedded_conformer_i"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.read_rdkit_embedded_conformer_i" title="Permalink to this definition">¶</a></dt>
<dd><p>Read coordinates from RDKit conformers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>rd_mol</strong> (<em>RDKit RDMol</em>) – The RDKit molecule with embedded conformers to optimize.</li>
<li><strong>i</strong> (<em>int</em>) – The conformer index from rd_mol to read.</li>
<li><strong>rd_index_map</strong> (<em>list</em><em>, </em><em>optional</em>) – An atom map dictionary to reorder the xyz. Requires mol to not be None.</li>
<li><strong>mol</strong> (<em>Molecule</em><em>, </em><em>optional</em>) – The RMG molecule object with connectivity and bond order information.</li>
<li><strong>return_xyz_strings</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return xyz in string or array format. True for string.
Requires mol to not be None to return string format.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">xyz coordinates in the desired format.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list or str</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.read_rdkit_embedded_conformers">
<code class="descclassname">arc.species.conformers.</code><code class="descname">read_rdkit_embedded_conformers</code><span class="sig-paren">(</span><em>label</em>, <em>rd_mol</em>, <em>i=None</em>, <em>rd_index_map=None</em>, <em>mol=None</em>, <em>return_xyz_strings=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#read_rdkit_embedded_conformers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.read_rdkit_embedded_conformers" title="Permalink to this definition">¶</a></dt>
<dd><p>Read coordinates from RDKit conformers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>rd_mol</strong> (<em>RDKit RDMol</em>) – The RDKit molecule with embedded conformers to optimize.</li>
<li><strong>i</strong> (<em>int</em><em>, </em><em>optional</em>) – The conformer index from rd_mol to read. If None, all will be read,</li>
<li><strong>rd_index_map</strong> (<em>list</em><em>, </em><em>optional</em>) – An atom map dictionary to reorder the xyz. Requires mol to not be None.</li>
<li><strong>mol</strong> (<em>Molecule</em><em>, </em><em>optional</em>) – The RMG molecule object with connectivity and bond order information.</li>
<li><strong>return_xyz_strings</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return xyz in string or array format. True for string.
Requires mol to not be None to return string format.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">xyz coordinates in the desired format.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.rotate_vector">
<code class="descclassname">arc.species.conformers.</code><code class="descname">rotate_vector</code><span class="sig-paren">(</span><em>point_a</em>, <em>point_b</em>, <em>normal</em>, <em>theta</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#rotate_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.rotate_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate a vector in 3D space around a given axis by a certain angle.</p>
<p>Inspired by <a class="reference external" href="https://stackoverflow.com/questions/6802577/rotation-of-3d-vector">https://stackoverflow.com/questions/6802577/rotation-of-3d-vector</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>point_a</strong> (<em>list</em>) – The 3D coordinates of the starting point (point A) of the vector to be rotated.</li>
<li><strong>point_b</strong> (<em>list</em>) – The 3D coordinates of the ending point (point B) of the vector to be rotated.</li>
<li><strong>normal</strong> (<em>list</em>) – The axis to be rotated around.</li>
<li><strong>theta</strong> (<em>float</em>) – The degree in radians by which to rotate.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The rotated vector (the new coordinates for point B).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.to_group">
<code class="descclassname">arc.species.conformers.</code><code class="descname">to_group</code><span class="sig-paren">(</span><em>mol</em>, <em>atom_indices</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#to_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.to_group" title="Permalink to this definition">¶</a></dt>
<dd><p>This method converts a defined part of a Molecule into a Group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mol</strong> (<em>Molecule</em>) – The base molecule.</li>
<li><strong>atom_indices</strong> (<em>list</em>) – 0-indexed atom indices corresponding to atoms in mol to be included in the group.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A group consisting of the desired atoms in mol.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Group</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.translate_group">
<code class="descclassname">arc.species.conformers.</code><code class="descname">translate_group</code><span class="sig-paren">(</span><em>mol</em>, <em>xyz</em>, <em>pivot</em>, <em>anchor</em>, <em>vector</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#translate_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.translate_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate a group (a set of atoms from the pivot towards the anchor and onwards) by changing its
pivot -&gt; anchor vector to the desired new vector. Keep the relative distances between the group’s atoms constant,
as well as the distance between the anchor and the vector atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mol</strong> (<em>Molecule</em>) – The 2D graph representation of the molecule.</li>
<li><strong>xyz</strong> (<em>str</em>) – A string-format 3d coordinates of the molecule with the same atom order as in mol.</li>
<li><strong>pivot</strong> (<em>int</em>) – The 0-index of the pivotal atom around which groups are to be translated.</li>
<li><strong>anchor</strong> (<em>int</em>) – The 0-index of an anchor atom. The group is defined from the pivot atom to the anchor atom,
including all other atoms in the molecule connected to the anchor. The pivot and anchor
atoms should not have another path connecting them such as a ring.</li>
<li><strong>vector</strong> (<em>list</em>) – The new vector by which the group will be translated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The translated coordinates.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">str</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.translate_groups">
<code class="descclassname">arc.species.conformers.</code><code class="descname">translate_groups</code><span class="sig-paren">(</span><em>label</em>, <em>mol</em>, <em>xyz</em>, <em>pivot</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#translate_groups"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.translate_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Exchange between two groups in a molecule. The groups cannot share a ring with the pivotal atom.
The function does not change the atom order, just the coordinates of atoms.
If the pivotal atom has exactly one lone pair, consider it as well as a dummy atom in translations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>label</strong> (<em>str</em>) – The species’ label.</li>
<li><strong>mol</strong> (<em>Molecule</em>) – The 2D graph representation of the molecule.</li>
<li><strong>xyz</strong> (<em>str</em>) – A string-format 3d coordinates of the molecule with the same atom order as in mol.</li>
<li><strong>pivot</strong> (<em>int</em>) – The 0-index of the pivotal atom around which groups are to be translated.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.unit_vector">
<code class="descclassname">arc.species.conformers.</code><code class="descname">unit_vector</code><span class="sig-paren">(</span><em>vector</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#unit_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.unit_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a unit vector in the same direction as the input vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>vector</strong> (<em>list</em>) – The input vector.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The unit vector.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="arc.species.conformers.update_mol">
<code class="descclassname">arc.species.conformers.</code><code class="descname">update_mol</code><span class="sig-paren">(</span><em>mol</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/arc/species/conformers.html#update_mol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#arc.species.conformers.update_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Update atom types, multiplicity, and atom charges in the molecule.
<em>untested</em></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mol</strong> (<em>Molecule</em>) – The molecule to update.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the updated molecule.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Molecule</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="reaction.html" class="btn btn-neutral float-right" title="arc.reaction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="converter.html" class="btn btn-neutral float-left" title="arc.species.converter" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2019, Alon Grinberg Dana

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>